<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate Particle Size Control Section Weighted Average — pscs_weighted • SOILmilaR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate Particle Size Control Section Weighted Average — pscs_weighted"><meta name="description" content="Calculates the particle size control section weighted average for one or more variables (vars), using upper and lower boundary specified in pscsbounds. Profiles are truncated to the interval set by these bounds, and weighted averages are calculated for each column. The result has the same number of rows as the number of sites in the input SoilProfileCollection x and is suitable for joining back into the site table"><meta property="og:description" content="Calculates the particle size control section weighted average for one or more variables (vars), using upper and lower boundary specified in pscsbounds. Profiles are truncated to the interval set by these bounds, and weighted averages are calculated for each column. The result has the same number of rows as the number of sites in the input SoilProfileCollection x and is suitable for joining back into the site table"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SOILmilaR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/similar-soils-loafercreek.html">Similar Soils with Loafercreek</a></li>
    <li><a class="dropdown-item" href="../articles/synthetic-transects.html">Synthetic Transects</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="http://github.com/brownag/SOILmilaR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculate Particle Size Control Section Weighted Average</h1>
      <small class="dont-index">Source: <a href="http://github.com/brownag/SOILmilaR/blob/main/R/pscs_weighted.R" class="external-link"><code>R/pscs_weighted.R</code></a></small>
      <div class="d-none name"><code>pscs_weighted.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates the particle size control section weighted average for one or more variables (<code>vars</code>), using upper and lower boundary specified in <code>pscsbounds</code>. Profiles are truncated to the interval set by these bounds, and weighted averages are calculated for each column. The result has the same number of rows as the number of sites in the input SoilProfileCollection <code>x</code> and is suitable for joining back into the site table</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pscs_weighted</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">vars</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  pscsbounds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"psctopdepth"</span>, <span class="st">"pscbotdepth"</span><span class="op">)</span>,</span>
<span>  prefix <span class="op">=</span> <span class="st">"pscs_"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A <em>SoilProfileCollection</em></p></dd>


<dt id="arg-vars">vars<a class="anchor" aria-label="anchor" href="#arg-vars"></a></dt>
<dd><p><em>character</em>. Column names of numeric variables in horizon table of <code>x</code> to summarize.</p></dd>


<dt id="arg-na-rm">na.rm<a class="anchor" aria-label="anchor" href="#arg-na-rm"></a></dt>
<dd><p><em>logical</em>. Remove <code>NA</code>? Default: <code>FALSE</code></p></dd>


<dt id="arg-pscsbounds">pscsbounds<a class="anchor" aria-label="anchor" href="#arg-pscsbounds"></a></dt>
<dd><p><em>character</em> of length 2. Column names of numeric variables in site table representing the profile specific upper and lower boundary. Default: <code>"psctopdepth"</code> and <code>"pscbotdepth"</code></p></dd>


<dt id="arg-prefix">prefix<a class="anchor" aria-label="anchor" href="#arg-prefix"></a></dt>
<dd><p><em>character</em>. Prefix to append before column name, to create unique name that does not conflict with existing horizon data. Default: <code>"pscs_"</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data.frame-like object corresponding to <code>aqp_df_class(x)</code></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># load aqp, and data from soilDB</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ncss-tech/aqp" class="external-link">aqp</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> This is aqp 2.2-1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">loafercreek</span>, package <span class="op">=</span> <span class="st">"soilDB"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># calculate PSCS weighted clay % and total fragment volume</span></span></span>
<span class="r-in"><span><span class="va">pscs_cf</span> <span class="op">&lt;-</span> <span class="fu">pscs_weighted</span><span class="op">(</span><span class="va">loafercreek</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"clay"</span>, <span class="st">"fragvoltot"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># inspect</span></span></span>
<span class="r-in"><span><span class="va">pscs_cf</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      peiid pscs_clay pscs_fragvoltot</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   115595  28.76471        0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   115819  28.76471        0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   115827  25.88000        0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   207242  16.00000       16.770270</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   207255  37.32000       21.440000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   268820  32.63415       13.853659</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   307957  33.78571        1.285714</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   307961  29.57576        7.727273</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   307963  29.00000        8.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  338021  23.02632       30.789474</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  338022  25.28000       19.400000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  338023  23.36364       37.454545</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  338024  26.25000       11.666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  338025  34.12000       34.460000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  338026  47.69565       13.695652</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16  338027  30.73171       23.780488</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17  338028  28.32609       25.543478</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18  338029  32.00000       10.714286</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  338040  27.12500       26.250000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20  338041  27.76316       22.894737</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21  338042  25.00000       14.777778</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22  338043  28.60870        5.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23  338044  23.39535       27.093023</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24  338045  22.32000        5.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25  338046  24.10000       26.140000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26  342445  20.91600       29.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27  346008  22.52000       29.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28  351695  20.48780       31.390244</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29  351700  44.38000       25.180000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30  351701  37.88000       11.500000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31  351703  28.70000        7.500000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32  351716  28.80000       54.420000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33  351717  36.46000        4.700000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34  374201  23.78000       44.140000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35  374205  30.72000       17.360000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36  374216  24.33333       35.733333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37  374219  23.76000        6.640000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38  374232  21.78000       12.440000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39  414895  28.72727        9.772727</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40  414934  20.83871       15.258065</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41  414936  19.56000       32.460000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42  414938  25.48000       23.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43  425293  28.92000       16.900000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44  463690  33.95122       35.243902</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45  477042  20.18000        5.680000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46  477055  18.86486       48.135135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47  477056  18.12500       69.270833</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48  477057  25.56000       20.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49  477059  17.34000       23.980000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50  488565  25.84000       31.360000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51  488568  19.00000        5.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52  488573  28.37500       30.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53  488578  27.10870       50.543478</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54  488581  24.72000       24.200000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55  488582  26.20370       55.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56  488587  25.13514       52.027027</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57  488596  26.00000       50.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58  488602  24.38000       43.900000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59  488636  24.20000       16.720000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60  493742  26.24000       23.560000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61  530603  27.44444        0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62  530611  29.90000        5.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63  530649        NA        0.880000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64  530692  42.08000       16.100000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65  530693  28.34000       10.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66  530694  29.36842       31.052632</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67  530699  23.10000        8.500000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68  530731  24.56818       15.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69  530740  29.10000       15.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70  530744  24.16000        7.200000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71  530751  28.82000       17.200000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72  533172        NA        0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73  533272  18.77500       17.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74  533337        NA        0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75  533462  45.82917       23.791667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 76  533888  25.25161        5.967742</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 77  533889        NA       15.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 78  542093  20.50000       20.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 79  542095  21.28889       34.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 80  542125  24.86000        9.280000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 81  542129  32.34000        0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 82  542130  33.36585       25.804878</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 83  542131  31.04000       13.560000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 84  542153  23.05405       36.108108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 85  542154  17.22000        0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 86  620521  26.52000       28.300000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 87  620522  29.22000       16.820000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 88  620523  20.00000       39.642857</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 89  625813  24.60000       51.620000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90  625821  19.74000       28.620000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 91  640607  18.25000       19.375000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 92  640610  20.70000        5.900000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 93  640616  31.84000        2.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 94  640625  21.97959        4.387755</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95  640629  32.44737       29.078947</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 96  640630  29.56000       24.400000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 97   64505  22.09412        0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 98  839192  21.34000       14.900000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 99  839203  27.46154        5.538462</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100 894094  26.68000        0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 101 894095  20.10526        7.105263</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 102 894118  31.00000        5.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 103 894145  22.65000       27.750000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># left join to site table of loafercreek</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/aqp/man/site.html" class="external-link">site</a></span><span class="op">(</span><span class="va">loafercreek</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">pscs_cf</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Andrew Brown.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

