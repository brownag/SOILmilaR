<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Synthetic Transects • SOILmilaR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Synthetic Transects">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SOILmilaR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/similar-soils-loafercreek.html">Similar Soils with Loafercreek</a></li>
    <li><a class="dropdown-item" href="../articles/synthetic-transects.html">Synthetic Transects</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="http://github.com/brownag/SOILmilaR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Synthetic Transects</h1>
            
      
      <small class="dont-index">Source: <a href="http://github.com/brownag/SOILmilaR/blob/main/vignettes/synthetic-transects.Rmd" class="external-link"><code>vignettes/synthetic-transects.Rmd</code></a></small>
      <div class="d-none name"><code>synthetic-transects.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/brownag/SOILmilaR" class="external-link">SOILmilaR</a></span><span class="op">)</span></span></code></pre></div>
<p>Set pseudorandom number generator seed for consistent results between
runs (optional).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></code></pre></div>
<p>Next we will generate some sample data representing 5 “synthetic
transects”.</p>
<p>We assume a similar “soil forming function” for these transects
across each hypothetical “delineation” being transected.</p>
<p>Here the values have been customized so that taxonomic particle size
is fine-loamy, but coarser textured in higher fragment material. Soil
depth varies from shallow to very deep, uniform but centered around
moderately deep. <code>pscs_*</code> quantities provided for example
numeric quantities that can be used.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">'rbind'</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, \<span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">i</span><span class="op">)</span>,</span>
<span>           taxpartsize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fine-loamy"</span>,<span class="st">"loamy"</span>,<span class="st">"fine-loamy"</span>,<span class="st">"fine-loamy"</span>,</span>
<span>                           <span class="st">"coarse-loamy"</span>, <span class="st">"coarse-loamy"</span>, <span class="st">"coarse-loamy"</span>,</span>
<span>                           <span class="st">"loamy-skeletal"</span>, <span class="st">"loamy-skeletal"</span>, <span class="st">"loamy-skeletal"</span><span class="op">)</span>,</span>
<span>           depth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">35</span>, <span class="fl">150</span><span class="op">)</span>,</span>
<span>           pscs_clay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">18</span>, <span class="fl">35</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">14</span>, <span class="fl">18</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           pscs_frags <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">15</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">10</span>, <span class="fl">34</span><span class="op">)</span>,</span>
<span>                          <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">35</span>, <span class="fl">60</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">40</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Next we define some rating functions for particle size class and
depth class.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rate_taxpartsize</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_match.html" class="external-link">case_match</a></span><span class="op">(</span><span class="va">x</span>,</span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sandy-skeletal"</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>,</span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sandy"</span><span class="op">)</span> <span class="op">~</span> <span class="fl">3</span>,</span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"loamy"</span>, <span class="st">"coarse-loamy"</span>, <span class="st">"coarse-silty"</span><span class="op">)</span> <span class="op">~</span> <span class="fl">5</span>,</span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fine-loamy"</span>, <span class="st">"fine-silty"</span><span class="op">)</span> <span class="op">~</span> <span class="fl">7</span>,</span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"clayey"</span>, <span class="st">"fine"</span><span class="op">)</span> <span class="op">~</span> <span class="fl">9</span>,</span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"very-fine"</span><span class="op">)</span> <span class="op">~</span> <span class="fl">11</span>,</span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"loamy-skeletal"</span>, <span class="st">"clayey-skeletal"</span><span class="op">)</span> <span class="op">~</span> <span class="fl">13</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">rate_depthclass</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,</span>
<span>                            <span class="va">breaks</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>                              `very shallow` <span class="op">=</span> <span class="fl">25</span>,</span>
<span>                              `shallow` <span class="op">=</span> <span class="fl">50</span>,</span>
<span>                              `moderately deep` <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                              `deep` <span class="op">=</span> <span class="fl">150</span>,</span>
<span>                              `very deep` <span class="op">=</span> <span class="fl">1e4</span></span>
<span>                            <span class="op">)</span>,</span>
<span>                            <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">breaks</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">res</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">breaks</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The above rating functions can be combined in a list (<code>m</code>)
which will be use used as the <code>mapping</code> argument to
<code><a href="../reference/similar_soils.html">similar_soils()</a></code>. The <code><a href="../reference/similar_soils.html">similar_soils()</a></code> function
applies the rating functions to the columns of the input data
<code>x</code>. Target column names in the data match the names of
<code>m</code>, providing the “mapping” of data to rating functions.</p>
<p>Now we will demonstrate iterative filtering and application of
similar soils criteria.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>taxpartsize <span class="op">=</span> <span class="va">rate_taxpartsize</span>,</span>
<span>          depth <span class="op">=</span>  <span class="va">rate_depthclass</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/similar_soils.html">similar_soils</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">m</span><span class="op">)</span></span>
<span><span class="co">#&gt; comparing to dominant reference condition (`13.3` on 6 rows)</span></span>
<span><span class="va">res0</span></span>
<span><span class="co">#&gt;    id taxpartsize depth similar_dist similar_single similar</span></span>
<span><span class="co">#&gt; 1  A1           7     3            6              6   FALSE</span></span>
<span><span class="co">#&gt; 2  B1           5     4            9              8   FALSE</span></span>
<span><span class="co">#&gt; 3  C1           7     3            6              6   FALSE</span></span>
<span><span class="co">#&gt; 4  D1           7     4            7              6   FALSE</span></span>
<span><span class="co">#&gt; 5  E1           5     4            9              8   FALSE</span></span>
<span><span class="co">#&gt; 6  F1           5     2            9              8   FALSE</span></span>
<span><span class="co">#&gt; 7  G1           5     3            8              8   FALSE</span></span>
<span><span class="co">#&gt; 8  H1          13     4            1              1    TRUE</span></span>
<span><span class="co">#&gt; 9  I1          13     3            0              0    TRUE</span></span>
<span><span class="co">#&gt; 10 J1          13     3            0              0    TRUE</span></span>
<span><span class="co">#&gt; 11 A2           7     4            7              6   FALSE</span></span>
<span><span class="co">#&gt; 12 B2           5     4            9              8   FALSE</span></span>
<span><span class="co">#&gt; 13 C2           7     4            7              6   FALSE</span></span>
<span><span class="co">#&gt; 14 D2           7     4            7              6   FALSE</span></span>
<span><span class="co">#&gt; 15 E2           5     2            9              8   FALSE</span></span>
<span><span class="co">#&gt; 16 F2           5     3            8              8   FALSE</span></span>
<span><span class="co">#&gt; 17 G2           5     4            9              8   FALSE</span></span>
<span><span class="co">#&gt; 18 H2          13     3            0              0    TRUE</span></span>
<span><span class="co">#&gt; 19 I2          13     3            0              0    TRUE</span></span>
<span><span class="co">#&gt; 20 J2          13     3            0              0    TRUE</span></span>
<span><span class="co">#&gt; 21 A3           7     4            7              6   FALSE</span></span>
<span><span class="co">#&gt; 22 B3           5     2            9              8   FALSE</span></span>
<span><span class="co">#&gt; 23 C3           7     3            6              6   FALSE</span></span>
<span><span class="co">#&gt; 24 D3           7     3            6              6   FALSE</span></span>
<span><span class="co">#&gt; 25 E3           5     4            9              8   FALSE</span></span>
<span><span class="co">#&gt; 26 F3           5     3            8              8   FALSE</span></span>
<span><span class="co">#&gt; 27 G3           5     4            9              8   FALSE</span></span>
<span><span class="co">#&gt; 28 H3          13     4            1              1    TRUE</span></span>
<span><span class="co">#&gt; 29 I3          13     4            1              1    TRUE</span></span>
<span><span class="co">#&gt; 30 J3          13     3            0              0    TRUE</span></span></code></pre></div>
<p>Identifying soils similar to <code>"13.3"</code> (moderately deep,
skeletal), corresponds to a major, dominant, component in a map
unit.</p>
<p>We might consider selecting a different reference condition manually
after inspection. If we were to do that we could set, for example,
<code>condition="7.4"</code> to compare against condition
<code>"7.4"</code> rather than <code>"13.3"</code> that was
automatically selected in this example.</p>
<p>Next, let’s take the remaining dissimilar soils, and re-apply the
similarity criteria based on the next-most-dominant condition.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/aqp/man/subset-SoilProfileCollection-method.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">x</span>, <span class="op">!</span><span class="va">res0</span><span class="op">$</span><span class="va">similar</span>, select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"taxpartsize"</span>, <span class="st">"depth"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/similar_soils.html">similar_soils</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">m</span><span class="op">)</span></span>
<span><span class="co">#&gt; comparing to dominant reference condition (`5.4` on 6 rows)</span></span>
<span><span class="va">res1</span></span>
<span><span class="co">#&gt;    id taxpartsize depth similar_dist similar_single similar</span></span>
<span><span class="co">#&gt; 1  A1           7     3            3              2   FALSE</span></span>
<span><span class="co">#&gt; 2  B1           5     4            0              0    TRUE</span></span>
<span><span class="co">#&gt; 3  C1           7     3            3              2   FALSE</span></span>
<span><span class="co">#&gt; 4  D1           7     4            2              2   FALSE</span></span>
<span><span class="co">#&gt; 5  E1           5     4            0              0    TRUE</span></span>
<span><span class="co">#&gt; 6  F1           5     2            2              2   FALSE</span></span>
<span><span class="co">#&gt; 7  G1           5     3            1              1    TRUE</span></span>
<span><span class="co">#&gt; 11 A2           7     4            2              2   FALSE</span></span>
<span><span class="co">#&gt; 12 B2           5     4            0              0    TRUE</span></span>
<span><span class="co">#&gt; 13 C2           7     4            2              2   FALSE</span></span>
<span><span class="co">#&gt; 14 D2           7     4            2              2   FALSE</span></span>
<span><span class="co">#&gt; 15 E2           5     2            2              2   FALSE</span></span>
<span><span class="co">#&gt; 16 F2           5     3            1              1    TRUE</span></span>
<span><span class="co">#&gt; 17 G2           5     4            0              0    TRUE</span></span>
<span><span class="co">#&gt; 21 A3           7     4            2              2   FALSE</span></span>
<span><span class="co">#&gt; 22 B3           5     2            2              2   FALSE</span></span>
<span><span class="co">#&gt; 23 C3           7     3            3              2   FALSE</span></span>
<span><span class="co">#&gt; 24 D3           7     3            3              2   FALSE</span></span>
<span><span class="co">#&gt; 25 E3           5     4            0              0    TRUE</span></span>
<span><span class="co">#&gt; 26 F3           5     3            1              1    TRUE</span></span>
<span><span class="co">#&gt; 27 G3           5     4            0              0    TRUE</span></span></code></pre></div>
<p>At this second step, <code>"5.4"</code> (coarse-loamy, deep) is the
dominant condition, also identified as similar are <code>"5.3"</code>
(loamy, moderately deep)</p>
<p>One might consider which one of these is the best representative
condition for the map unit (including unobserved areas) regardless of
what is “dominant” in the observation data.</p>
<p>If there are issues with dissimilar soils being included in the same
groups, consider revising the rating functions to ensure dissimilar
properties have a distance greater than the set threshold
(<code>thresh_single</code>). With <code><a href="../reference/similar_soils.html">similar_soils()</a></code>, you can
specify an alternate <code>condition</code> to compare against, or a
<code>thresh_single</code> value higher or lower than
<code>2</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/aqp/man/subset-SoilProfileCollection-method.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">x</span>, <span class="op">!</span><span class="va">x</span><span class="op">$</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">res0</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">res0</span><span class="op">$</span><span class="va">similar</span><span class="op">]</span>, <span class="va">res1</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">res1</span><span class="op">$</span><span class="va">similar</span><span class="op">]</span><span class="op">)</span>,</span>
<span>            select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"taxpartsize"</span>, <span class="st">"depth"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">res2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/similar_soils.html">similar_soils</a></span><span class="op">(</span><span class="va">z</span>, <span class="va">m</span><span class="op">)</span></span>
<span><span class="co">#&gt; comparing to dominant reference condition (`7.4` on 5 rows)</span></span>
<span><span class="va">res2</span></span>
<span><span class="co">#&gt;    id taxpartsize depth similar_dist similar_single similar</span></span>
<span><span class="co">#&gt; 1  A1           7     3            1              1    TRUE</span></span>
<span><span class="co">#&gt; 3  C1           7     3            1              1    TRUE</span></span>
<span><span class="co">#&gt; 4  D1           7     4            0              0    TRUE</span></span>
<span><span class="co">#&gt; 6  F1           5     2            4              2   FALSE</span></span>
<span><span class="co">#&gt; 11 A2           7     4            0              0    TRUE</span></span>
<span><span class="co">#&gt; 13 C2           7     4            0              0    TRUE</span></span>
<span><span class="co">#&gt; 14 D2           7     4            0              0    TRUE</span></span>
<span><span class="co">#&gt; 15 E2           5     2            4              2   FALSE</span></span>
<span><span class="co">#&gt; 21 A3           7     4            0              0    TRUE</span></span>
<span><span class="co">#&gt; 22 B3           5     2            4              2   FALSE</span></span>
<span><span class="co">#&gt; 23 C3           7     3            1              1    TRUE</span></span>
<span><span class="co">#&gt; 24 D3           7     3            1              1    TRUE</span></span></code></pre></div>
<p>Applying the similar soils criteria again, we find <code>"7.4"</code>
is next most dominant, and <code>"7.3"</code> is similar to it.</p>
<p>We are left with a few soils that are not similar to any of the prior
3 sets:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/aqp/man/subset-SoilProfileCollection-method.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">res2</span>, <span class="op">!</span><span class="va">similar</span><span class="op">)</span></span>
<span><span class="co">#&gt;    id taxpartsize depth similar_dist similar_single similar</span></span>
<span><span class="co">#&gt; 6  F1           5     2            4              2   FALSE</span></span>
<span><span class="co">#&gt; 15 E2           5     2            4              2   FALSE</span></span>
<span><span class="co">#&gt; 22 B3           5     2            4              2   FALSE</span></span></code></pre></div>
<p>We see that all 3 of the remaining soils are <code>"5.2"</code>
(loamy, shallow).</p>
<p>Let’s reconstruct a data.frame, with the 4 groups of similar soils
each identified with a greek letter. We will see which is the most
prevalent overall based on the whole dataset. We could also assess
prevalence within individual transects.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="st">'rbind'</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>component <span class="op">=</span> <span class="va">greekletters</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/pkg/aqp/man/subset-SoilProfileCollection-method.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">res0</span>, <span class="va">similar</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>component <span class="op">=</span> <span class="va">greekletters</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/pkg/aqp/man/subset-SoilProfileCollection-method.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">res1</span>, <span class="va">similar</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>component <span class="op">=</span> <span class="va">greekletters</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/pkg/aqp/man/subset-SoilProfileCollection-method.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">res2</span>, <span class="va">similar</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>component <span class="op">=</span> <span class="va">greekletters</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/pkg/aqp/man/subset-SoilProfileCollection-method.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">res2</span>, <span class="op">!</span><span class="va">similar</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># label any unassigned observations</span></span>
<span><span class="va">una</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/aqp/man/subset-SoilProfileCollection-method.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">res0</span>, <span class="op">!</span><span class="va">res0</span><span class="op">$</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">fin</span><span class="op">$</span><span class="va">id</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/aqp/man/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">una</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">fin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">fin</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>component <span class="op">=</span> <span class="st">"unassigned"</span>, <span class="va">una</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># put in original order of dataset</span></span>
<span><span class="va">fin</span> <span class="op">&lt;-</span> <span class="va">fin</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">id</span>, <span class="va">fin</span><span class="op">$</span><span class="va">id</span><span class="op">)</span>, <span class="op">]</span></span></code></pre></div>
<p>We can tabulate the assignments we made and see how that corresponds
with our concept for the relative abundance of the soils on the
landscape in the typical delineation.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">fin</span><span class="op">$</span><span class="va">component</span><span class="op">)</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">res</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Alpha  Beta Gamma Delta </span></span>
<span><span class="co">#&gt;   0.3   0.3   0.3   0.1</span></span></code></pre></div>
<p>In this case, we see Alpha, Beta and Gamma as major components, and
Delta as a lesser component. However, Delta is dissimilar (and shallow,
which is likely strongly contrasting) compared to all of the prior
soils, so if we accept the observation proportions as map unit component
percentages we would have a four major component map unit.</p>
<p>It may be that there are other miscellaneous areas, or
more-rarely-observed, unique, contrasting soils that were not captured
as distinct by the rating functions. These could be split off either by
creating a rating to capture them, or just noting their presence as
minor components.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># TODO: abstract this concept</span></span>
<span><span class="va">cmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/aqp/man/subset-SoilProfileCollection-method.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">fin</span>, <span class="va">component</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">res</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">cmp</span><span class="op">$</span><span class="va">taxpartsize</span>, <span class="va">cmp</span><span class="op">$</span><span class="va">depth</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fin_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/similar_soils.html">similar_soils</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">m</span>, <span class="va">ref</span><span class="op">)</span></span>
<span><span class="co">#&gt; comparing to dominant reference condition (`13.3` on 6 rows)</span></span>
<span></span>
<span><span class="co"># transfer similarity distance and similar ranking</span></span>
<span><span class="va">fin</span><span class="op">$</span><span class="va">similar_dist</span> <span class="op">&lt;-</span> <span class="va">fin_sim</span><span class="op">$</span><span class="va">similar_dist</span></span>
<span><span class="va">fin</span><span class="op">$</span><span class="va">similar</span> <span class="op">&lt;-</span> <span class="va">fin_sim</span><span class="op">$</span><span class="va">similar</span> <span class="co"># similarity to the dominant condition within Beta</span></span>
<span></span>
<span><span class="co"># original sort order</span></span>
<span><span class="va">fin</span></span>
<span><span class="co">#&gt;    component id taxpartsize depth similar_dist similar_single similar</span></span>
<span><span class="co">#&gt; 1      Gamma A1           7     3            6              1   FALSE</span></span>
<span><span class="co">#&gt; 2       Beta B1           5     4            9              0   FALSE</span></span>
<span><span class="co">#&gt; 3      Gamma C1           7     3            6              1   FALSE</span></span>
<span><span class="co">#&gt; 4      Gamma D1           7     4            7              0   FALSE</span></span>
<span><span class="co">#&gt; 5       Beta E1           5     4            9              0   FALSE</span></span>
<span><span class="co">#&gt; 6      Delta F1           5     2            9              2   FALSE</span></span>
<span><span class="co">#&gt; 7       Beta G1           5     3            8              1   FALSE</span></span>
<span><span class="co">#&gt; 8      Alpha H1          13     4            1              1    TRUE</span></span>
<span><span class="co">#&gt; 9      Alpha I1          13     3            0              0    TRUE</span></span>
<span><span class="co">#&gt; 10     Alpha J1          13     3            0              0    TRUE</span></span>
<span><span class="co">#&gt; 11     Gamma A2           7     4            7              0   FALSE</span></span>
<span><span class="co">#&gt; 12      Beta B2           5     4            9              0   FALSE</span></span>
<span><span class="co">#&gt; 13     Gamma C2           7     4            7              0   FALSE</span></span>
<span><span class="co">#&gt; 14     Gamma D2           7     4            7              0   FALSE</span></span>
<span><span class="co">#&gt; 15     Delta E2           5     2            9              2   FALSE</span></span>
<span><span class="co">#&gt; 16      Beta F2           5     3            8              1   FALSE</span></span>
<span><span class="co">#&gt; 17      Beta G2           5     4            9              0   FALSE</span></span>
<span><span class="co">#&gt; 18     Alpha H2          13     3            0              0    TRUE</span></span>
<span><span class="co">#&gt; 19     Alpha I2          13     3            0              0    TRUE</span></span>
<span><span class="co">#&gt; 20     Alpha J2          13     3            0              0    TRUE</span></span>
<span><span class="co">#&gt; 21     Gamma A3           7     4            7              0   FALSE</span></span>
<span><span class="co">#&gt; 22     Delta B3           5     2            9              2   FALSE</span></span>
<span><span class="co">#&gt; 23     Gamma C3           7     3            6              1   FALSE</span></span>
<span><span class="co">#&gt; 24     Gamma D3           7     3            6              1   FALSE</span></span>
<span><span class="co">#&gt; 25      Beta E3           5     4            9              0   FALSE</span></span>
<span><span class="co">#&gt; 26      Beta F3           5     3            8              1   FALSE</span></span>
<span><span class="co">#&gt; 27      Beta G3           5     4            9              0   FALSE</span></span>
<span><span class="co">#&gt; 28     Alpha H3          13     4            1              1    TRUE</span></span>
<span><span class="co">#&gt; 29     Alpha I3          13     4            1              1    TRUE</span></span>
<span><span class="co">#&gt; 30     Alpha J3          13     3            0              0    TRUE</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="4%">
<col width="14%">
<col width="4%">
<col width="17%">
<col width="8%">
<col width="18%">
<col width="21%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="left">component</th>
<th align="left">id</th>
<th align="right">taxpartsize</th>
<th align="right">depth</th>
<th align="right">similar_dist</th>
<th align="right">similar_single</th>
<th align="left">similar</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">9</td>
<td align="left">Alpha</td>
<td align="left">I1</td>
<td align="right">13</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">10</td>
<td align="left">Alpha</td>
<td align="left">J1</td>
<td align="right">13</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">18</td>
<td align="left">Alpha</td>
<td align="left">H2</td>
<td align="right">13</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">19</td>
<td align="left">Alpha</td>
<td align="left">I2</td>
<td align="right">13</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">20</td>
<td align="left">Alpha</td>
<td align="left">J2</td>
<td align="right">13</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">30</td>
<td align="left">Alpha</td>
<td align="left">J3</td>
<td align="right">13</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">8</td>
<td align="left">Alpha</td>
<td align="left">H1</td>
<td align="right">13</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">28</td>
<td align="left">Alpha</td>
<td align="left">H3</td>
<td align="right">13</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">29</td>
<td align="left">Alpha</td>
<td align="left">I3</td>
<td align="right">13</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">Gamma</td>
<td align="left">A1</td>
<td align="right">7</td>
<td align="right">3</td>
<td align="right">6</td>
<td align="right">1</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">Gamma</td>
<td align="left">C1</td>
<td align="right">7</td>
<td align="right">3</td>
<td align="right">6</td>
<td align="right">1</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">23</td>
<td align="left">Gamma</td>
<td align="left">C3</td>
<td align="right">7</td>
<td align="right">3</td>
<td align="right">6</td>
<td align="right">1</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">24</td>
<td align="left">Gamma</td>
<td align="left">D3</td>
<td align="right">7</td>
<td align="right">3</td>
<td align="right">6</td>
<td align="right">1</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">Gamma</td>
<td align="left">D1</td>
<td align="right">7</td>
<td align="right">4</td>
<td align="right">7</td>
<td align="right">0</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">11</td>
<td align="left">Gamma</td>
<td align="left">A2</td>
<td align="right">7</td>
<td align="right">4</td>
<td align="right">7</td>
<td align="right">0</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">13</td>
<td align="left">Gamma</td>
<td align="left">C2</td>
<td align="right">7</td>
<td align="right">4</td>
<td align="right">7</td>
<td align="right">0</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">14</td>
<td align="left">Gamma</td>
<td align="left">D2</td>
<td align="right">7</td>
<td align="right">4</td>
<td align="right">7</td>
<td align="right">0</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">21</td>
<td align="left">Gamma</td>
<td align="left">A3</td>
<td align="right">7</td>
<td align="right">4</td>
<td align="right">7</td>
<td align="right">0</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">7</td>
<td align="left">Beta</td>
<td align="left">G1</td>
<td align="right">5</td>
<td align="right">3</td>
<td align="right">8</td>
<td align="right">1</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">16</td>
<td align="left">Beta</td>
<td align="left">F2</td>
<td align="right">5</td>
<td align="right">3</td>
<td align="right">8</td>
<td align="right">1</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">26</td>
<td align="left">Beta</td>
<td align="left">F3</td>
<td align="right">5</td>
<td align="right">3</td>
<td align="right">8</td>
<td align="right">1</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">Beta</td>
<td align="left">B1</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">9</td>
<td align="right">0</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">Beta</td>
<td align="left">E1</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">9</td>
<td align="right">0</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="left">Delta</td>
<td align="left">F1</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">9</td>
<td align="right">2</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">12</td>
<td align="left">Beta</td>
<td align="left">B2</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">9</td>
<td align="right">0</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">15</td>
<td align="left">Delta</td>
<td align="left">E2</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">9</td>
<td align="right">2</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">17</td>
<td align="left">Beta</td>
<td align="left">G2</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">9</td>
<td align="right">0</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">22</td>
<td align="left">Delta</td>
<td align="left">B3</td>
<td align="right">5</td>
<td align="right">2</td>
<td align="right">9</td>
<td align="right">2</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">25</td>
<td align="left">Beta</td>
<td align="left">E3</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">9</td>
<td align="right">0</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">27</td>
<td align="left">Beta</td>
<td align="left">G3</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">9</td>
<td align="right">0</td>
<td align="left">FALSE</td>
</tr>
</tbody>
</table></main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Andrew Brown.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
